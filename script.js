const contentDiv = document.getElementById('content');
const nextButton = document.getElementById('next-button');
const heartsContainer = document.getElementById('hearts-container');

let currentLevel = 0;

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –∞–Ω–∏–º–∞—Ü–∏–∏ —Å–µ—Ä–¥–µ—á–∫–∞
function createHeart() {
    const heart = document.createElement('div');
    heart.classList.add('heart');
    heart.innerHTML = '‚ù§Ô∏è'; // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–∏–º–≤–æ–ª —Å–µ—Ä–¥–µ—á–∫–∞

    // –°–ª—É—á–∞–π–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –≤–Ω–∏–∑—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
    const startX = Math.random() * heartsContainer.offsetWidth;
    heart.style.left = `${startX}px`;
    heart.style.bottom = '-20px'; // –ù–∞—á–∏–Ω–∞–µ–º –Ω–∏–∂–µ –≤–∏–¥–∏–º–æ–π –æ–±–ª–∞—Å—Ç–∏

    // –°–ª—É—á–∞–π–Ω—ã–π —Ä–∞–∑–º–µ—Ä
    const size = Math.random() * 15 + 15; // –û—Ç 15 –¥–æ 30px
    heart.style.fontSize = `${size}px`;

    // –°–ª—É—á–∞–π–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏
    const duration = Math.random() * 3 + 4; // –û—Ç 4 –¥–æ 7 —Å–µ–∫—É–Ω–¥
    heart.style.animationDuration = `${duration}s`;

    heartsContainer.appendChild(heart);

    // –£–¥–∞–ª—è–µ–º —Å–µ—Ä–¥–µ—á–∫–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏
    heart.addEventListener('animationend', () => {
        heart.remove();
    });
}

// –ó–∞–ø—É—Å–∫–∞–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–¥–µ—á–µ–∫ –∫–∞–∂–¥—ã–µ 300ms (–º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å)
let heartInterval = null;

function startHeartRain() {
     heartInterval = setInterval(createHeart, 300); // –°–æ–∑–¥–∞–µ–º —Å–µ—Ä–¥–µ—á–∫–æ –∫–∞–∂–¥—ã–µ 300–º—Å
     // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–æ–∂–¥—å —Å–µ—Ä–¥–µ—á–µ–∫ —á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è
     setTimeout(() => {
         clearInterval(heartInterval);
     }, 10000); // –ü—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–¥–µ—á–µ–∫ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥ (–º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å)
}

// –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
function updateContent() {
    contentDiv.innerHTML = ''; // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç

    if (currentLevel === 0) {
         // –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∫–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å"
         // –ö–æ–Ω—Ç–µ–Ω—Ç –ø—É—Å—Ç–æ–π –∏–ª–∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–æ –ø–µ—Ä–≤–æ–≥–æ –Ω–∞–∂–∞—Ç–∏—è
          contentDiv.innerHTML = `
            <h1>–ü—Ä–∏–≤–µ—Ç, –º–æ—è –¥–æ—Ä–æ–≥–∞—è –ê–π–∂–∞–Ω–∞! ‚ú®</h1>
            <p>–Ø –ø—Ä–∏–≥–æ—Ç–æ–≤–∏–ª –¥–ª—è —Ç–µ–±—è –º–∞–ª–µ–Ω—å–∫–æ–µ —Å—é—Ä–ø—Ä–∏–∑-–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ.</p>
            <p>–ù–∞–∂–º–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏!</p>
         `;
         nextButton.textContent = '–ì–æ—Ç–æ–≤–∞? –ñ–º–∏ —Å—é–¥–∞!';
         nextButton.style.display = 'block'; // –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ –≤–∏–¥–Ω–∞

    } else if (currentLevel === 1) {
        // –ü–µ—Ä–≤—ã–π —É—Ä–æ–≤–µ–Ω—å: –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
        contentDiv.innerHTML = `
            <h1>–ü—Ä–∏–≤–µ—Ç, –º–æ—è –ø—Ä–µ–∫—Ä–∞—Å–Ω–∞—è –ê–π–∂–∞–Ω–∞! ‚ù§Ô∏è</h1>
            <p>–≠—Ç–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –Ω–∞ –æ—Å–æ–±–µ–Ω–Ω–æ–µ —Å–≤–∏–¥–∞–Ω–∏–µ, –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω–æ–µ —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ–±—è.</p>
            <p>–ù–∞–¥–µ—é—Å—å, –æ–Ω–æ —Ç–µ–±–µ –ø–æ–Ω—Ä–∞–≤–∏—Ç—Å—è!</p>
            <p>–ß—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ, –Ω–∞–∂–º–∏ "–î–∞–ª—å—à–µ".</p>
        `;
        nextButton.textContent = '–î–∞–ª—å—à–µ! –ñ–¥—É!';
        nextButton.style.display = 'block';
        startHeartRain(); // –ó–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–¥–µ—á–∫–∏

    } else if (currentLevel === 2) {
        // –í—Ç–æ—Ä–æ–π —É—Ä–æ–≤–µ–Ω—å: –í—Ä–µ–º—è –∏ –º–µ—Å—Ç–æ
        contentDiv.innerHTML = `
            <h1>–ù–∞—à–µ —Å–≤–∏–¥–∞–Ω–∏–µ ‚ú®</h1>
            <p>–í–æ—Ç —Å–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ:</p>
            <p><strong>–í—Ä–µ–º—è –≤—Å—Ç—Ä–µ—á–∏:</strong> 20:15</p>
            <p><strong>–ú–µ—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∏:</strong> –ü—Ä–∏—Å—Ç–∞–Ω—å, –†–µ—á–Ω–æ–π –≤–æ–∫–∑–∞–ª</p>
            <p>–ñ–¥—É —Ç–µ–±—è —Å –Ω–µ—Ç–µ—Ä–ø–µ–Ω–∏–µ–º! ü•∞</p>
        `;
        nextButton.textContent = '–ü–æ–Ω—è–ª–∞! –î–æ –≤—Å—Ç—Ä–µ—á–∏!'; // –ò–∑–º–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏
        // nextButton.style.display = 'none'; // –ú–æ–∂–µ—à—å —Å–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —à–∞–≥–∞, –∏–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å —Å –Ω–æ–≤—ã–º —Ç–µ–∫—Å—Ç–æ–º
        // clearInterval(heartInterval); // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–¥–µ—á–µ–∫ –ø–æ—Å–ª–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —à–∞–≥–∞
    } else {
        // –ï—Å–ª–∏ —É—Ä–æ–≤–Ω–∏ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å
        contentDiv.innerHTML = `
            <h1>–£–≤–∏–¥–∏–º—Å—è —Å–∫–æ—Ä–æ! ü•∞</h1>
            <p>–ù–∞–¥–µ—é—Å—å, —Ç–µ–±–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å —ç—Ç–æ –º–∞–ª–µ–Ω—å–∫–æ–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ.</p>
            <p>–î–æ –≤—Å—Ç—Ä–µ—á–∏ –Ω–∞ —Å–≤–∏–¥–∞–Ω–∏–∏!</p>
        `;
        nextButton.style.display = 'none'; // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
         clearInterval(heartInterval); // –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ —Å–µ—Ä–¥–µ—á–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
    }
}

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫—É
nextButton.addEventListener('click', () => {
    currentLevel++; // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å
    updateContent(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
});

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener('DOMContentLoaded', () => {
     // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp API (–¥–µ–ª–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–º –∏ —Ç.–¥.)
    if (window.Telegram && window.Telegram.WebApp) {
        Telegram.WebApp.ready(); // –£–≤–µ–¥–æ–º–ª—è–µ–º Telegram, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ
        Telegram.WebApp.expand(); // –†–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
         // Telegram.WebApp.setBackgroundColor('#ffccdd'); // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –∑–∞–¥–∞—Ç—å —Ñ–æ–Ω –∏–∑ API
    } else {
        console.log('Telegram WebApp API –Ω–µ –Ω–∞–π–¥–µ–Ω. –í–æ–∑–º–æ–∂–Ω–æ, –æ—Ç–∫—Ä—ã—Ç–æ –Ω–µ –≤ Telegram.');
        // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–≥–ª—É—à–∫—É –∏–ª–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –≤–Ω–µ Telegram
    }

    updateContent(); // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç (–£—Ä–æ–≤–µ–Ω—å 0 –∏–ª–∏ 1)
});